<div class="container-fluid">
  <h1>Loan application form</h1>
  <form #userForm="ngForm" *ngIf="!submited" (ngSubmit)="onSubmit()" novalidate>

    {{ userForm.value | json }}
    <hr />
    {{userModel | json}}
    <div class="form-group">
      <label>First Name</label>
      <input type="text" required minlength="2" #firstName="ngModel" 
        [class.is-invalid]="firstName.invalid && firstName.touched" class="form-control" 
        name="firstName" [(ngModel)]="userModel.firstName">
      <small class="text-danger" [class.d-none]="firstName.valid || firstName.untouched">First name is a required and should be at least 2 character long.</small>
    </div>


    <div class="form-group">
      <label>Last Name</label>
      <input type="text" required minlength="2" #lastName="ngModel" 
      [class.is-invalid]="lastName.invalid && lastName.touched" class="form-control" 
        name="lastName" [(ngModel)]="userModel.lastName">
      <small class="text-danger" [class.d-none]="lastName.valid || lastName.untouched">Last name is a required and should be at least 2 character long.</small>
    </div>



    <div ngModelGroup="address">
      <div class="form-group">
        <label>Street</label>
        <input type="text" class="form-control" name="street" ngModel>
      </div>
      <div class="form-group">
        <label>Street 2 (optional)</label>
        <input type="text" class="form-control" name="street2" ngModel>
      </div>
      <div class="form-group">
        <label>City</label>
        <input type="text" class="form-control" name="city" ngModel>
      </div>
      <div class="form-group">
          <label>Select State</label>
        <select required #state="ngModel" class="custom-select" name="state" ngModel>
          <option value>Select state</option>
          <option *ngFor="let state of states">{{state}}</option>
        </select>
      </div>
      <div class="form-group">
          <label>Zip Code</label>
          <input type="text" class="form-control" name="zipCode" ngModel>
        </div>
    </div>



    <div class="form-group">
      <label>Email</label>
      <input type="email" required minlength="5" #email="ngModel"
      [class.is-invalid]="email.invalid && email.touched" class="form-control" 
      name="email" [(ngModel)]="userModel.email">
      <small class="text-danger" [class.d-none]="email.valid || email.untouched">A valid email is required.</small>
    </div>

    <div class="form-group">
      <label>Phone Number</label>
      <input type="tel" #phone="ngModel" pattern="^\d{10}$" required
        [class.is-invalid]="phone.invalid && phone.touched"  class="form-control" name="phone" (ngModel)="userModel.phone">
        <small class="text-danger" [class.d-none]="phone.valid || phone.untouched">Phone number must be 10 digits long.</small>
      </div>

      <label>Age</label>
    <div class="form-group">
        
      <select class="custom-select" (blur)="validateAge(age.value)" (change)="validateAge(age.value)" #age="ngModel" [class.is-invalid]="ageHasError && age.touched" name="age" [(ngModel)]="userModel.age">
        <option value="default">Please enter your age</option>
        <option *ngFor="let age of ages">{{age}}</option>
      </select>
      <small class="text-danger" [class.d-none]="!ageHasError || age.untouched">Please indicate your age.</small>
    </div>

    <button class="btn btn-primary" [disabled]="userForm.form.invalid || ageHasError" type="submit">Submit loan application</button>
  </form>

  <div class="alert alert-danger" *ngIf="errorMsg">
    {{errorMsg}}
  </div>
</div>